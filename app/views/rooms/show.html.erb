<div class="min-h-screen" style="background-color: #f9fafb;">
  <div class="max-w-6xl mx-auto px-4 py-8">
    <!-- Header -->
    <div class="bg-white shadow-sm p-6 mb-6" style="border-radius: 12px;">
      <div style="display: flex; align-items: center; justify-content: space-between;">
        <div>
          <%= link_to "#{arrow_left_icon} #{t('rooms.back_to_dashboard')}".html_safe, root_path, class: "text-gray-600 hover:text-gray-800 font-medium mb-3 inline-block", style: "color: #6b7280; text-decoration: none; font-weight: 500; margin-bottom: 0.75rem; display: inline-block;" %>
          <div style="display: flex; align-items: center; gap: 1rem;">
            <div style="width: 64px; height: 64px; border-radius: 50%; background: linear-gradient(to right, #7c3aed, #8b5cf6); display: flex; align-items: center; justify-content: center;">
              <span style="font-size: 1.5rem; font-weight: 700; color: white;"><%= user_icon %></span>
            </div>
            <div>
              <h1 style="font-size: 1.875rem; font-weight: 700; color: #111827;"><%= @room.name %></h1>
              <p style="font-size: 1.125rem; color: #6b7280;">5ª Divisão - Temporada 2025</p>
            </div>
          </div>
        </div>
        <div style="display: flex; gap: 0.75rem;">
          <% if @clubs.any? && @clubs.available.any? %>
            <%= button_to "#{dice_icon} Sorteio Aleatório".html_safe, choose_random_club_room_path(@room), method: :patch,
                data: { confirm: t('rooms.random_selection_confirm') },
                style: "background-color: #228B22; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 500; cursor: pointer; transition: all 0.2s;" %>
          <% end %>
          <%= link_to "#{arrow_left_icon} Voltar ao Dashboard".html_safe, root_path,
              style: "border: 1px solid #d1d5db; background: white; color: #374151; text-decoration: none; padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 500; display: inline-block;" %>
        </div>
      </div>
    </div>

    <!-- Teams Table -->
    <div class="bg-white shadow-sm p-6" style="border-radius: 12px;">
      <div style="margin-bottom: 1rem;">
        <h3 class="text-lg font-semibold" style="font-size: 1.125rem; font-weight: 600;"><%= t('rooms.clubs_in_room') %> (<%= @clubs.count %>)</h3>
        <p class="text-sm text-gray-600" style="font-size: 0.875rem; color: #6b7280;"><%= t('rooms.club_selection_help') || 'Clique em um time para selecioná-lo' %></p>
      </div>

      <!-- Table Header -->
      <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr; gap: 1rem; padding: 1rem; background: #f9fafb; border-radius: 8px; margin-bottom: 1rem; font-weight: 600; color: #374151; border-bottom: 2px solid #e5e7eb;">
        <div><%= t('clubs.name') || 'Time' %></div>
        <div class="text-center" style="text-align: center;"><%= t('clubs.overall_average') || 'Média' %> <%= trophy_icon %></div>
        <div class="text-center" style="text-align: center;"><%= t('clubs.budget_label') || 'Orçamento' %></div>
        <div class="text-center" style="text-align: center;"><%= t('clubs.stadium_label') || 'Estádio' %></div>
        <div class="text-center" style="text-align: center;"><%= t('common.actions') || 'Ação' %></div>
      </div>

      <!-- Teams List -->
      <div style="max-height: 600px; overflow-y: auto;">
        <% @clubs.each_with_index do |club, index| %>
          <%
            initials = club.name.split.map(&:first).join[0..2].upcase
            avg_overall = club.players.any? ? (club.players.average(:overall) / 20).round(1) : 0
            budget_formatted = number_with_delimiter(club.budget / 1000)
          %>

          <div class="team-row <%= club.available? ? '' : 'opacity-75' %>"
               style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr; gap: 1rem; padding: 1rem; border: 1px solid #e5e7eb; border-radius: 8px; margin-bottom: 0.5rem; align-items: center; cursor: pointer; transition: all 0.2s; <%= club.available? ? '' : 'opacity: 0.75;' %>; background: linear-gradient(135deg, <%= club_primary_color(club) %>10 0%, <%= club_primary_color(club) %>05 100%);"
               onmouseover="this.style.borderColor='<%= club_primary_color(club) %>'; this.style.boxShadow='0 2px 8px rgba(0,0,0,0.1)'"
               onmouseout="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'">
            <div style="display: flex; align-items: center; gap: 1rem;">
              <div class="avatar" style="<%= club_avatar_style(club, '48px') %>">
                <%= initials %>
              </div>
              <div>
                <h4 style="font-weight: 600;"><%= club.name %></h4>
                <p style="font-size: 0.875rem; color: #6b7280;">
                  <%= t('clubs.founded_year') || 'Fundado em' %> <%= club.founded_year || (1985 + index) %> • <%= club.city %>
                </p>
              </div>
            </div>
            <div class="text-center font-semibold" style="text-align: center; font-weight: 600;">
              <%= avg_overall %><%= trophy_icon %>
            </div>
            <div class="text-center font-semibold" style="text-align: center; font-weight: 600; color: #0047AB;">
              R$ <%= budget_formatted %>K
            </div>
            <div class="text-center" style="text-align: center;">
              <%= number_with_delimiter(club.stadium_capacity || (5000 + rand(15000))) %>
            </div>
            <div class="text-center" style="text-align: center;">
              <% if club.available? %>
                <%= button_to t('rooms.choose_club') || 'Escolher', club_path(club), method: :patch,
                    data: { confirm: "Tem certeza que deseja escolher #{club.name}?" },
                    style: "background-color: #0047AB; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 8px; font-weight: 500; cursor: pointer; transition: all 0.2s; text-decoration: none; display: inline-block; text-align: center; font-size: 0.875rem;" %>
              <% else %>
                <span style="color: #6b7280; font-size: 0.875rem;"><%= t('rooms.taken') || 'Ocupado' %></span>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>

      <!-- Bottom Info -->
      <div style="margin-top: 1.5rem; padding: 1rem; background: #f9fafb; border-radius: 8px; text-align: center;">
        <p style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.5rem;">
          <%= lightbulb_icon %> <strong><%= t('rooms.tip') || 'Dica' %>:</strong> <%= t('rooms.tip_message') || 'Times com menor média têm maior orçamento inicial' %>
        </p>
        <p style="font-size: 0.875rem; color: #6b7280;">
          <%= target_icon %> <strong><%= t('rooms.objective') || 'Objetivo' %>:</strong> <%= t('rooms.objective_message') || 'Subir da 5ª para a 1ª divisão conquistando promoções' %>
        </p>
      </div>
    </div>

    <!-- Quick Actions -->
    <% if @room.status == 'waiting' && @room.user == current_user %>
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 mt-6" style="background-color: #eff6ff; border: 1px solid #93c5fd; border-radius: 12px; padding: 1.5rem; margin-top: 1.5rem;">
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div>
            <h3 style="font-weight: 600; color: #1e3a8a;"><%= t('rooms.ready_to_start') %></h3>
            <p style="font-size: 0.875rem; color: #1e40af;"><%= t('rooms.room_ready') %></p>
          </div>
          <%= button_to t('rooms.start_game'), start_game_room_path(@room), method: :patch,
              data: { confirm: "Tem certeza que deseja iniciar o jogo?" },
              style: "padding: 0.75rem 1.5rem; color: white; border-radius: 8px; font-weight: 500; cursor: pointer; transition: all 0.2s; background-color: #0047AB; border: none;" %>
        </div>
      </div>
    <% end %>
  </div>
</div>
